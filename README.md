# detection_app - Object Detection Video Evaluator

## 概要

`detection_app`は、物体認識モデルの動画に対する動作検証を目的としたアプリケーションです。動画ファイルを再生し、再生位置の制御やウィンドウサイズの動的調整を行うことができます。

## 機能

現在、以下の主要な機能が実装されています。

-   **動画ファイルの再生**:
    *   OpenCVライブラリをベースに、指定された動画ファイルを再生します。
    *   再生中に以前の動画データが混ざってしまう不具合を修正しました。
-   **ウィンドウサイズの動的調整**:
    *   「再生」ボタンをクリックすると、再生する動画の解像度に合わせてアプリケーションのウィンドウサイズが自動的に調整されます。UIコントロールの表示領域を確保するため、動画の高さに80ピクセルのパディングが追加されます。
-   **シークバーによる再生位置の制御**:
    *   動画の総再生時間と現在の再生時間を「MM:SS / MM:SS」形式でUIに表示します。
    *   スライダー形式のシークバー（タイムライン）が実装されており、ユーザーはシークバーを操作することで動画の任意の再生位置へ移動できます。
    *   シーク処理が失敗した場合には、デバッグ目的で標準エラー出力に簡易的なログが出力されます。
-   **`video_reader`モジュールのリファクタリング**:
    *   動画のデコードと読み込みロジックを`FrameDecoder`と`VideoReader`に分割し、コードの保守性とテスト容易性を向上させました。
    *   `FrameDecoder`はOpenCV `VideoCapture`を利用して動画のFPS、幅、高さを取得し、`VideoReader`はこれらの情報を公開します。
-   **ユニットテスト**:
    *   `FrameDecoder`に対して、存在しないファイルパスや空のファイルパスが指定された場合の挙動を確認するユニットテストが実装されています。これにより、外部の動画ファイルに依存しない、堅牢なテストが可能になっています。

## セットアップとビルド

### 前提条件

-   Rustツールチェインがインストールされていること。
-   OpenCVライブラリがシステムにインストールされていること。Rustの`opencv`クレートは、システムにインストールされたOpenCVライブラリにリンクします。詳細なインストール手順は、OpenCVの公式ドキュメントまたはお使いのOSのパッケージマネージャーの情報を参照してください。

### ビルド

プロジェクトのルートディレクトリで以下のコマンドを実行します。

```bash
cargo build --release
```

### 実行

ビルドが完了したら、以下のコマンドでアプリケーションを実行できます。

```bash
cargo run --release
```

## 使い方

1.  アプリケーションを起動します。
2.  「Select Video File...」ボタンをクリックし、再生したい動画ファイル（例: `.mp4`, `.avi`, `.mov`）を選択します。
3.  「Play」ボタンをクリックすると、動画の再生が始まり、ウィンドウサイズが動画の解像度に合わせて調整されます。
4.  画面下部に表示されるシークバーをドラッグすることで、動画の任意の再生位置に移動できます。
5.  「Pause」ボタンで再生を一時停止/再開できます。

## 今後の展望

-   物体認識モデルを動画フレームに適用し、その結果をリアルタイムで表示する機能を追加する予定です。
-   （音声再生機能については、本アプリケーションの目的外であるため、現時点では実装を見送ります。）
